<meta charset="utf-8">
<title>{% if page.title %}{{ page.title }}{% else %}{{ site.name }}{% endif %}</title>

<!-- Enable responsiveness on mobile devices-->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

<script src="/js/all.js"></script>
{% for css in page.css %}<link rel="stylesheet" href="{{ css }}">{% endfor %}
{% for js in page.js %}<script src="{{ js }}"></script>{% endfor %}

<link rel="stylesheet" href="/css/all.css">
<link href='//fonts.googleapis.com/css?family=Lato:900,300' rel='stylesheet' type='text/css'>

{% if page.robots %}
<meta name="robots" content="{{ page.robots }}" />
{% endif %}

<link rel="alternate" type="application/atom+xml" title="James Malcolm" href="http://feeds.feedburner.com/jgmalcolm">
<link rel="shortcut icon" href="/favicon.ico">

{% include open-graph.html %}

<script>
$(document).ready(function(){

  /* headers get hover anchor tags and added to TOC */
  var toc = $("#toc"), toc_count = 0;
  $(".content :header").each(function(i,e) {
    var $e = $(e), id = $e.attr('id'), text = $e.text();
    if (id) {
      $e.append($("<a/>").addClass("header-link").attr("href", "#" + id).html("#"));
      if (toc_count < 7 && e.tagName.match("H1|H2")) {
        var nav = $("<tr/>").attr("href", "#" + id).html("<td>" + text + "</td");
        toc.append(nav);
        toc_count++;
      }
    }
  });

  /* clickable TOC */
  $("#toc tr").click(function() {
    window.document.location = $(this).attr("href");
  });

  /* highlight broken markdown links */
  var broken = $(".content").html().match(/\[.*?\][\[\(].*?[\]\)]/);
  if (broken) {
    $(document.body).append("<span style='position:fixed;width:100%;top:0;color:red;background-color:yellow'>Broken:<br> " + broken + "</span>");
  }

  /* remove click delays on mobile */
  FastClick.attach(document.body);
});
</script>
